{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"/Users/kashi-lab/github/tangochou/utils/dbUtils.tsx\";\nvar __jsx = React.createElement;\nimport * as React from 'react';\nimport { escape } from './strUtils';\nexport const getWords = () => {\n  fetch('http://localhost:3001/vocab').then(res => res.json()).then(json => {\n    //console.log(json);\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 9\n      },\n      __self: this\n    }, \"hello\");\n  });\n};\nexport async function addWord(word, textId)\n/*, defs: string[] */\n{\n  word = escape(word);\n  const vRes = await fetch('http://localhost:3001/vocab');\n  const vData = await vRes.json();\n  const vocab = vData.map(item => item.word); // add to vocab\n\n  if (!vocab.includes(word.toLowerCase())) {\n    fetch('http://localhost:3001/vocab', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: _JSON$stringify({\n        word: word.toLowerCase()\n      })\n    }).then(getWords);\n  } // add to word list (for text)\n\n\n  let tRes = await fetch(`http://localhost:3001/texts/?id=${textId}`);\n  let tData = await tRes.json();\n  tData = tData[0];\n  const wordList = tData.wordlist;\n  wordList.push(word);\n  console.log(wordList);\n  tRes = await fetch(`http://localhost:3001/texts/${textId}`, {\n    method: 'PUT',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json'\n    },\n    body: _JSON$stringify({\n      text: tData.text,\n      desc: tData.desc,\n      title: tData.title,\n      wordlist: wordList\n    })\n  });\n}\nexport async function getTextTitles() {\n  const res = await fetch('http://localhost:3001/texts');\n  const data = await res.json();\n  const elements = [];\n  data.map(item => elements.push(__jsx(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, item.title)));\n  return __jsx(React.Fragment, null, elements);\n}\nexport async function deleteWord(word, textId) {\n  word = escape(word); // remove from vocab\n\n  const vRes = await fetch(`http://localhost:3001/vocab?word=${word.toLowerCase()}`);\n  const vData = await vRes.json();\n\n  if (vData.length) {\n    const vId = vData[0].id;\n    fetch(`http://localhost:3001/vocab/${vId}`, {\n      method: 'DELETE'\n    }).then(getWords).catch(e => {\n      console.log(e);\n    });\n  } // delete from to word list (for text)\n\n\n  let tRes = await fetch(`http://localhost:3001/texts/?id=${textId}`);\n  let tData = await tRes.json();\n  tData = tData[0];\n  const wordList = tData.wordlist;\n  const i = wordList.indexOf(word);\n  console.log(wordList);\n  if (i > -1) wordList.splice(i, 1);\n  console.log(wordList);\n  tRes = await fetch(`http://localhost:3001/texts/${textId}`, {\n    method: 'PUT',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json'\n    },\n    body: _JSON$stringify({\n      text: tData.text,\n      desc: tData.desc,\n      title: tData.title,\n      wordlist: wordList\n    })\n  });\n}","map":{"version":3,"sources":["/Users/kashi-lab/github/tangochou/utils/dbUtils.tsx"],"names":["React","escape","getWords","fetch","then","res","json","addWord","word","textId","vRes","vData","vocab","map","item","includes","toLowerCase","method","headers","Accept","body","tRes","tData","wordList","wordlist","push","console","log","text","desc","title","getTextTitles","data","elements","deleteWord","length","vId","id","catch","e","i","indexOf","splice"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { escape } from './strUtils';\n\nexport const getWords = () => {\n  fetch('http://localhost:3001/vocab')\n    .then(res => res.json())\n    .then(json => {\n      //console.log(json);\n      return <div>hello</div>;\n    });\n};\nexport async function addWord(\n  word: string,\n  textId: number /*, defs: string[] */,\n) {\n  word = escape(word);\n  const vRes = await fetch('http://localhost:3001/vocab');\n  const vData = await vRes.json();\n  const vocab = vData.map(item => item.word);\n  // add to vocab\n  if (!vocab.includes(word.toLowerCase())) {\n    fetch('http://localhost:3001/vocab', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ word: word.toLowerCase() }),\n    }).then(getWords);\n  }\n  // add to word list (for text)\n  let tRes = await fetch(`http://localhost:3001/texts/?id=${textId}`);\n  let tData = await tRes.json();\n  tData = tData[0];\n  const wordList = tData.wordlist;\n  wordList.push(word);\n  console.log(wordList);\n  tRes = await fetch(`http://localhost:3001/texts/${textId}`, {\n    method: 'PUT',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      text: tData.text,\n      desc: tData.desc,\n      title: tData.title,\n      wordlist: wordList,\n    }),\n  });\n}\n\nexport async function getTextTitles() {\n  const res = await fetch('http://localhost:3001/texts');\n  const data = await res.json();\n  const elements = [];\n  data.map(item => elements.push(<li>{item.title}</li>));\n  return <>{elements}</>;\n}\n\nexport async function deleteWord(word: string, textId: number) {\n  word = escape(word);\n  // remove from vocab\n  const vRes = await fetch(\n    `http://localhost:3001/vocab?word=${word.toLowerCase()}`,\n  );\n  const vData = await vRes.json();\n  if (vData.length) {\n    const vId = vData[0].id;\n    fetch(`http://localhost:3001/vocab/${vId}`, {\n      method: 'DELETE',\n    })\n      .then(getWords)\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  // delete from to word list (for text)\n  let tRes = await fetch(`http://localhost:3001/texts/?id=${textId}`);\n  let tData = await tRes.json();\n  tData = tData[0];\n  const wordList = tData.wordlist;\n  const i = wordList.indexOf(word);\n  console.log(wordList);\n  if (i > -1) wordList.splice(i, 1);\n  console.log(wordList);\n  tRes = await fetch(`http://localhost:3001/texts/${textId}`, {\n    method: 'PUT',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      text: tData.text,\n      desc: tData.desc,\n      title: tData.title,\n      wordlist: wordList,\n    }),\n  });\n}\n"]},"metadata":{},"sourceType":"module"}